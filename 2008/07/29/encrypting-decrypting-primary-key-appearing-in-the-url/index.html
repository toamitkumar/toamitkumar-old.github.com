<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Encrypting/Decrypting Primary Key Appearing in the URL</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Encrypting/Decrypting Primary Key Appearing in the URL">
    <meta name="twitter:description" content="">

    <meta property="og:url" content="https://toamitkumar.com">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Encrypting/Decrypting Primary Key Appearing in the URL">
    <meta property="og:description" content="">
    <meta property="og:site_name" content="toamitkumar&#x27;s Code Blog">

    <meta itemprop="name" content="Encrypting/Decrypting Primary Key Appearing in the URL">
    <meta itemprop="description" content="">

    <meta name="twitter:site" content="@toamit">

<meta name="twitter:creator" content="@toamit">

<meta property="article:author" content="https://www.facebook.com/toamitkumar">

<meta property="article:publisher" content="https://www.facebook.com/toamitkumar">

<meta property="fb:admins" content="">

<meta name="google-site-verification" content="">

<link rel="author" href="https://plus.google.com/toamitkumar">

<meta name="theme-color" content="">

    <link href="/favicon.png" rel="shortcut icon" type="image/x-icon">
    <link href="/apple-touch-icon-precomposed.png" rel="apple-touch-icon">

    <link href="//fonts.googleapis.com/" rel="dns-prefetch">
    <link href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400&subset=latin,latin-ext" rel="stylesheet">

    <link rel="stylesheet" href="/assets/css/main.min.css?v=d4adf4d22c">

    <script type="text/javascript">
      var ga_ua = 'UA-27384947-1';

var disqus_shortname = 'toamitkumar';

var enable_pjax = true;

      // Pace Options
      // ==============
      window.paceOptions = {
        catchupTime: 100,
        minTime: 100,
        elements: false,
        restartOnRequestAfter: 500,
        startOnPageLoad: false
      }

      // Ghostium Globals
      // ==============
      window.GHOSTIUM = {};
      GHOSTIUM.haveGA = typeof ga_ua !== 'undefined' && ga_ua !== 'UA-XXXXX-X';
      GHOSTIUM.haveDisqus = typeof disqus_shortname !== 'undefined' && disqus_shortname !== 'example';
      GHOSTIUM.enablePjax = typeof enable_pjax !== 'undefined' ? enable_pjax : true;
    </script>

    <script src="/assets/js/head-scripts.min.js?v=d4adf4d22c"></script>

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="https://toamitkumar.com/2008/07/29/encrypting-decrypting-primary-key-appearing-in-the-url/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://toamitkumar.com/2008/07/29/encrypting-decrypting-primary-key-appearing-in-the-url/amp/" />
    
    <meta property="og:site_name" content="toamitkumar&#x27;s Code Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Encrypting/Decrypting Primary Key Appearing in the URL" />
    <meta property="og:description" content="I paid a small cost for being RESTful. As RESTful suggests, the GET request will always have the primary key in the URL like: http://somesite.com/somecontroller/123/edit In the app we have role based access and only admins have access to edit. We made sure that the" />
    <meta property="og:url" content="https://toamitkumar.com/2008/07/29/encrypting-decrypting-primary-key-appearing-in-the-url/" />
    <meta property="article:published_time" content="2008-07-29T04:13:00.000Z" />
    <meta property="article:modified_time" content="2018-02-02T04:20:07.000Z" />
    <meta property="article:tag" content="ruby" />
    <meta property="article:tag" content="rubyonrails" />
    <meta property="article:tag" content="rails-partials" />
    
    <meta property="article:publisher" content="https://www.facebook.com/toamitkumar" />
    <meta property="article:author" content="https://www.facebook.com/toamitkumar" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Encrypting/Decrypting Primary Key Appearing in the URL" />
    <meta name="twitter:description" content="I paid a small cost for being RESTful. As RESTful suggests, the GET request will always have the primary key in the URL like: http://somesite.com/somecontroller/123/edit In the app we have role based access and only admins have access to edit. We made sure that the" />
    <meta name="twitter:url" content="https://toamitkumar.com/2008/07/29/encrypting-decrypting-primary-key-appearing-in-the-url/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Amit Kumar" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="ruby, rubyonrails, rails-partials" />
    <meta name="twitter:site" content="@toamit" />
    <meta name="twitter:creator" content="@toamit" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "toamitkumar&#x27;s Code Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "https://toamitkumar.com/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Amit Kumar",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/e55cdf2544230f51d3e910dc4b4c1ae4?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://toamitkumar.com/author/toamitkumar/",
        "sameAs": [
            "http://toamitkumar.com",
            "https://www.facebook.com/toamitkumar",
            "https://twitter.com/toamit"
        ]
    },
    "headline": "Encrypting/Decrypting Primary Key Appearing in the URL",
    "url": "https://toamitkumar.com/2008/07/29/encrypting-decrypting-primary-key-appearing-in-the-url/",
    "datePublished": "2008-07-29T04:13:00.000Z",
    "dateModified": "2018-02-02T04:20:07.000Z",
    "keywords": "ruby, rubyonrails, rails-partials",
    "description": "I paid a small cost for being RESTful. As RESTful suggests, the GET request will always have the primary key in the URL like: http://somesite.com/somecontroller/123/edit In the app we have role based access and only admins have access to edit. We made sure that the",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://toamitkumar.com/"
    }
}
    </script>

    <script type="text/javascript" src="/public/ghost-sdk.js?v=d4adf4d22c"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "b2c76966b68d"
});
</script>
    <meta name="generator" content="Ghost 1.20" />
    <link rel="alternate" type="application/rss+xml" title="toamitkumar&#x27;s Code Blog" href="https://toamitkumar.com/rss" />
  </head>
  <body class="post-template tag-ruby tag-rubyonrails tag-rails-partials">

    <button data-action="open-drawer" id="drawer-button" class="drawer-button"><i class="fa fa-bars"></i></button>
<nav tabindex="-1" class="drawer">
  <div class="drawer-container">
    <!--.drawer-search(role="search")-->
    <ul role="navigation" class="drawer-list">
      
<li class="drawer-list-item">
  <a href="/" data-pjax>
    <i class="fa fa-home"></i>Home
  </a>
</li>
<li class="drawer-list-item">
  <a href="/about" data-pjax>
    <i class="fa fa-bell"></i>About me
  </a>
</li>
<li class="drawer-list-item">
  <a href="/speaking" data-pjax>
    <i class="fa fa-comments"></i>Speaking
  </a>
</li>
<li class="drawer-list-item">
  <a href="https://toamitkumar.com/rss">
    <i class="fa fa-rss"></i>Subscribe to Feed
  </a>
</li>
<li class="drawer-list-divider"></li>
<li class="drawer-list-item drawer-list-title">
  Follow me
</li>
<li class="drawer-list-item">
  <a href="https://twitter.com/toamit" target="_blank">
    <i class="fa fa-twitter"></i>Twitter
  </a>
</li>
<li class="drawer-list-item">
  <a href="https://github.com/toamitkumar" target="_blank">
    <i class="fa fa-github"></i>Github
  </a>
</li>
<li class="drawer-list-item">
  <a href="https://www.linkedin.com/in/toamitkumar/" target="_blank">
    <i class="fa fa-linkedin"></i>LinkedIn
  </a>
</li>    </ul>
  </div>
</nav>

    <div class="drawer-overlay"></div>
    <main id="container" role="main" class="container">
      <div class="surface">
        <div class="surface-container">
          <div data-pjax-container class="content">
            
<section class="wrapper wrapper-post">
  <div class="wrapper-container">
    <article itemscope itemtype="http://schema.org/BlogPosting" role="article" class="post post tag-ruby tag-rubyonrails tag-rails-partials">
        <section class="post-container">
          <header class="post-header">
            <ul class="post-meta-list">
              <li class="post-meta-item">
                <time datetime="2008-07-29" itemprop="datePublished">
                  10 years ago
                </time>
              </li>
                <li class="post-meta-item">
                    <a itemprop="articleSection" href="/tag/ruby/" data-pjax>ruby</a>, 
                    <a itemprop="keywords" href="/tag/rubyonrails/" data-pjax>rubyonrails</a>, 
                    <a itemprop="keywords" href="/tag/rails-partials/" data-pjax>rails-partials</a> 
                </li>
              <li class="post-meta-item">
                <a href="#disqus_thread" data-disqus-identifier="5a73dd3f09190f64e34a1a39">Comments</a>
              </li>
            </ul>
            <h1 itemprop="name headline" class="post-title"><a href="/2008/07/29/encrypting-decrypting-primary-key-appearing-in-the-url/" itemprop="url" data-pjax title="Encrypting/Decrypting Primary Key Appearing in the URL">Encrypting/Decrypting Primary Key Appearing in the URL</a></h1>
            <!--h2 itemprop="about" class="post-subtitle"></h2-->
          </header>
          <aside class="post-side">
            <div class="post-author">
                <a href="http://toamitkumar.com" class="post-author-avatar">
                  <img src="//www.gravatar.com/avatar/e55cdf2544230f51d3e910dc4b4c1ae4?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Amit Kumar">
                </a>
              <div class="post-author-info">
                <a href="http://toamitkumar.com" class="post-author-name">
                  Amit Kumar
                </a>
                <p class="post-author-bio"></p>
                <div class="post-social">
                  <a href="https://twitter.com/@toamit" target="_blank"><i class="fa fa-fw fa-lg fa-twitter"></i></a>
                  <a href="https://github.com/toamitkumar" target="_blank"><i class="fa fa-fw fa-lg fa-github"></i></a>
                  <a href="https://linkedin.com/in/toamitkumar/" target="_blank"><i class="fa fa-fw fa-lg fa-linkedin"></i></a>
                </div>
              </div>
            </div>
          </aside>
          <div itemprop="articleBody" class="post-body">
            <div class="kg-card-markdown"><p>I paid a small cost for being RESTful.</p>
<p>As RESTful suggests, the GET request will always have the primary key in the URL like: <a href="http://somesite.com/somecontroller/123/edit">http://somesite.com/somecontroller/123/edit</a></p>
<p>In the app we have role based access and only admins have access to edit. We made sure that the application is protected and only admins can update an existing record. The so called Security had a different perspective. They were not willing to expose the id(=123). The solution was to encrypt the id.</p>
<p>I came across a good blog <a href="http://jroller.com/obie/entry/seo_optimization_of_urls_in">here</a>.</p>
<p>Following the same concept:</p>
<ol>
<li>I added a <mark>EncryptDecryptHelper</mark> module inside my lib directory. The module has 2 methods.</li>
<li>encrypt -&gt; used <mark>OpenSSl Cipher RC4</mark> digest and Base64 encoding of the string for an already defined KEY and IV</li>
<li>decrypt -&gt; used the same KEY and IV to decode the string</li>
<li>Included the module inside my model and over-ride <mark>to_param</mark> to encrypt the primary key.</li>
<li>Added a before filter method on the application controller to decrypt the primary key.Made sure we are passing objects instead of id while creating links eg:-</li>
</ol>
<p><mark>Do this:</mark></p>
<pre><code>&lt;%= link_to 'city', :controller=&gt;‘cities’,:action=&gt;’show’,:id =&gt; @city %&gt;
</code></pre>
<p><mark>instead of:</mark></p>
<pre><code>&lt;%= link_to 'city', :controller=&gt;‘cities’,:action=&gt;’show’,:id =&gt; @city.id %&gt;
</code></pre>
<p>The security team is happy now.</p>
</div>
          </div>
          <footer class="post-footer">
            <div itemprop="author" itemscope itemtype="http://schema.org/Person" class="post-author">
                <a href="http://toamitkumar.com" class="post-author-avatar">
                  <img itemprop="image" src="//www.gravatar.com/avatar/e55cdf2544230f51d3e910dc4b4c1ae4?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Amit Kumar">
                </a>
              <div class="post-author-info">
                <h4 class="post-footer-heading">Written By</h4>
                <a href="http://toamitkumar.com" itemprop="url" class="post-author-name">
                  <span itemprop="name">Amit Kumar</span>
                </a>
                <p itemprop="description" class="post-author-bio"></p>
                  <p class="post-author-website">
                    <a href="http://toamitkumar.com" rel="nofollow">http://toamitkumar.com</a>
                  </p>
                <p class="post-info">
                  <b class="post-info-title">Published on</b>
                  <time class="post-date">July 29, 2008</time>
                </p>
              </div>
            </div>
            <div class="post-social">
              <h4 class="post-footer-heading">Spread the word</h4>
              <a href="#" data-action="share-twitter"><i class="fa fa-fw fa-lg fa-twitter"></i></a>
              <a href="#" data-action="share-facebook"><i class="fa fa-fw fa-lg fa-facebook"></i></a>
              <a href="#" data-action="share-gplus"><i class="fa fa-fw fa-lg fa-google-plus"></i></a>
            </div>
          </footer>
        </section>
      <section itemprop="comment" class="post-comments">
        <div id="disqus_thread"></div>
      </section>
    </article>

    <footer role="contentinfo" class="footer">
  <p><small>© 2018. All Rights Reserved.</small></p>
  <p><small><a href="http://ghostium.oswaldoacauan.com/" target="_blank">Ghostium Theme</a> by <a href="http://twitter.com/oswaldoacauan" target="_blank">@oswaldoacauan</a></small></p>
  <p><small>Proudly published with <a href="http://ghost.org" target="_blank">Ghost</a></small></p>
</footer>
  </div>
</section>

<script type="text/javascript">
  if(GHOSTIUM.haveDisqus) {
    var disqus_identifier = '5a73dd3f09190f64e34a1a39';

    if(typeof DISQUS !== 'object') {
      (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
    }
  } else {
    document.querySelector('.post-comments').remove();
  }
</script>

          </div>
        </div>
      </div>
    </main>

    

    <script src="/assets/js/foot-scripts.min.js?v=d4adf4d22c"></script>

    <script type="text/javascript">

      if(GHOSTIUM.haveGA) {
        (function(g,h,o,s,t,z){g.GoogleAnalyticsObject=s;g[s]||(g[s]=
        function(){(g[s].q=g[s].q||[]).push(arguments)});g[s].s=+new Date;
        t=h.createElement(o);z=h.getElementsByTagName(o)[0];
        t.src='//www.google-analytics.com/analytics.js';
        z.parentNode.insertBefore(t,z)}(window,document,'script','ga'));
        ga('create',ga_ua);ga('send','pageview');
      }

      if(GHOSTIUM.haveDisqus) {
        (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
      }
    </script>
  </body>
</html>
